2025/08/08 20:32:58 server.go:110: 添加上游服务 - 类型: hello, 地址: [localhost:8081]
2025/08/08 20:32:58 server.go:110: 添加上游服务 - 类型: business, 地址: [localhost:8082]
2025/08/08 20:32:58 server.go:110: 添加上游服务 - 类型: zone, 地址: [localhost:8083]
2025/08/08 20:32:58 server.go:122: 上游服务初始化完成 - 总服务数: 3, 已启用: 3
2025/08/08 20:32:58 overload_protector.go:155: 过载保护器已启用 - 最大连接: 1000, 最大QPS: 2000, 最大上游并发: 100
2025/08/08 20:32:58 server.go:128: 启动网关服务器...
2025/08/08 20:32:58 server_start.go:166: 已初始化上游服务连接管理器 - 配置服务数: 3
2025/08/08 20:32:58 manager.go:87: 已连接到上游服务: localhost:8083
2025/08/08 20:32:58 server_start.go:155: 预连接上游服务成功 - zone
2025/08/08 20:32:58 manager.go:87: 已连接到上游服务: localhost:8081
2025/08/08 20:32:58 server_start.go:155: 预连接上游服务成功 - hello
2025/08/08 20:32:58 manager.go:87: 已连接到上游服务: localhost:8082
2025/08/08 20:32:58 server_start.go:155: 预连接上游服务成功 - business
2025/08/08 20:32:58 server_start.go:38: QUIC监听器已启动: :8453
2025/08/08 20:32:58 server_start.go:81: HTTP服务器已启动: :8080
2025/08/08 20:32:58 server_start.go:95: 监控服务器已启动: :9090
2025/08/08 20:32:58 server_start.go:113: gRPC服务器已启动: :8092
2025/08/08 20:32:58 server.go:172: 网关服务器启动完成
2025/08/08 20:32:58 server.go:173: QUIC监听地址: :8453
2025/08/08 20:32:58 server.go:174: HTTP监听地址: :8080
2025/08/08 20:32:58 server.go:175: gRPC监听地址: :8092
2025/08/08 20:32:58 server.go:176: 监控地址: :9090
2025/08/08 20:32:58 server.go:177: 上游服务地址: 
2025/08/08 20:32:58 main.go:291: 网关服务器正在运行... (按Ctrl+C停止)
2025/08/08 20:33:51 server_connection.go:75: 新的QUIC连接: 127.0.0.1:58809
2025/08/08 20:33:51 server_connection.go:197: 等待第一个消息以获取身份标识 - 连接: 127.0.0.1:58809
2025/08/08 20:33:51 server_connection.go:241: 从第一个消息中提取身份信息 - OpenID: 42300, ClientID: 
2025/08/08 20:33:51 server_connection.go:245: 根据第一个消息提取出session - sessionid: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:51 server_connection.go:101: 创建会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:51 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:33:51.3643356 +0800 CST m=+52.993592301, 处理开始时间: 2025-08-08 20:33:51.3643356 +0800 CST m=+52.993592301
2025/08/08 20:33:51 handlers.go:274: 同步处理start请求 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 消息ID: 1
2025/08/08 20:33:51 ordered_sender.go:50: 为会话设置发送回调函数 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:51 ordered_sender.go:82: 有序消息发送成功 - 序列号: 1, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:51 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 1, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 1
2025/08/08 20:33:51 handlers.go:328: 同步处理连接建立请求成功 - OpenID: 42300, 客户端: 42300, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 状态: 0
2025/08/08 20:33:51 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 1, 成功: true, 处理时延: 0.51ms
2025/08/08 20:33:51 server_connection.go:299: 开始事件驱动消息处理 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:51 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:33:51.3648448 +0800 CST m=+52.994101501, 处理开始时间: 2025-08-08 20:33:51.3648448 +0800 CST m=+52.994101501
2025/08/08 20:33:51 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 客户端ACK: 1
2025/08/08 20:33:51 handlers.go:257: 收到ACK确认 - 序列号: 1, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 清除消息数: 1
2025/08/08 20:33:51 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:33:53 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:33:53.8395065 +0800 CST m=+55.468623801, 处理开始时间: 2025-08-08 20:33:51.3648448 +0800 CST m=+52.994101501
2025/08/08 20:33:53 handlers.go:51: 处理业务请求 - 动作: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:53 handlers.go:136: 路由业务请求 - 动作: hello, 目标服务: hello(localhost:8081)
2025/08/08 20:33:53 handlers.go:212: 登录成功，会话已激活 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, Zone: 1
2025/08/08 20:33:53 ordered_sender.go:82: 有序消息发送成功 - 序列号: 2, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:53 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 2, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 3
2025/08/08 20:33:53 handlers.go:181: 处理业务请求 - 动作: hello, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 响应码: 200, 时延: 解析=0.00ms, 上游=2.06ms
2025/08/08 20:33:53 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 4, 成功: true, 处理时延: 2.26ms
2025/08/08 20:33:53 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:33:53.8423142 +0800 CST m=+55.471431401, 处理开始时间: 2025-08-08 20:33:53.8395065 +0800 CST m=+55.468623801
2025/08/08 20:33:53 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 客户端ACK: 2
2025/08/08 20:33:53 handlers.go:257: 收到ACK确认 - 序列号: 2, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 清除消息数: 1
2025/08/08 20:33:53 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:33:56 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:33:56.9340187 +0800 CST m=+58.562961801, 处理开始时间: 2025-08-08 20:33:53.8423142 +0800 CST m=+55.471431401
2025/08/08 20:33:56 handlers.go:51: 处理业务请求 - 动作: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:56 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:33:56 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:33:56 ordered_sender.go:82: 有序消息发送成功 - 序列号: 3, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:33:56 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 3, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 4
2025/08/08 20:33:56 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 4, 成功: false, 处理时延: 0.00ms
2025/08/08 20:33:56 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:33:56.9350559 +0800 CST m=+58.563999001, 处理开始时间: 2025-08-08 20:33:56.9340187 +0800 CST m=+58.562961801
2025/08/08 20:33:56 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 客户端ACK: 3
2025/08/08 20:33:56 handlers.go:257: 收到ACK确认 - 序列号: 3, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 清除消息数: 1
2025/08/08 20:33:56 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:03 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:34:03.8474774 +0800 CST m=+65.476031301, 处理开始时间: 2025-08-08 20:33:56.9350559 +0800 CST m=+58.563999001
2025/08/08 20:34:03 handlers.go:51: 处理业务请求 - 动作: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:34:03 handlers.go:136: 路由业务请求 - 动作: echo, 目标服务: zone(localhost:8083)
2025/08/08 20:34:03 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:34:03 ordered_sender.go:82: 有序消息发送成功 - 序列号: 4, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6
2025/08/08 20:34:03 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 4, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 4
2025/08/08 20:34:03 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 4, 成功: false, 处理时延: 0.00ms
2025/08/08 20:34:03 server_connection.go:121: 处理消息 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 读取时间: 2025-08-08 20:34:03.8485239 +0800 CST m=+65.477077701, 处理开始时间: 2025-08-08 20:34:03.8474774 +0800 CST m=+65.476031301
2025/08/08 20:34:03 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 客户端ACK: 4
2025/08/08 20:34:03 handlers.go:257: 收到ACK确认 - 序列号: 4, 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 清除消息数: 1
2025/08/08 20:34:03 server_connection.go:190: 消息处理完成 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:11 server_connection.go:291: 读取消息出错，退出读取协程 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:34:11 server_connection.go:328: 读取消息失败 - 会话: fd2c4e72-6b8d-4dd5-b666-8ab2b10043c6, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:34:14 server_connection.go:75: 新的QUIC连接: 127.0.0.1:61841
2025/08/08 20:34:14 server_connection.go:197: 等待第一个消息以获取身份标识 - 连接: 127.0.0.1:61841
2025/08/08 20:34:14 server_connection.go:241: 从第一个消息中提取身份信息 - OpenID: 42300, ClientID: 
2025/08/08 20:34:14 server_connection.go:245: 根据第一个消息提取出session - sessionid: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:14 server_connection.go:247: 检测到重连 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端: , 用户: 42300
2025/08/08 20:34:14 server_connection.go:101: 创建会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:14 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:14.4910052 +0800 CST m=+76.118959901, 处理开始时间: 2025-08-08 20:34:14.4910052 +0800 CST m=+76.118959901
2025/08/08 20:34:14 handlers.go:274: 同步处理start请求 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 消息ID: 5
2025/08/08 20:34:14 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 4
2025/08/08 20:34:14 handlers.go:317: 重连时清除已确认消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 最后确认序列号: 4, 清除数量: 0
2025/08/08 20:34:14 ordered_sender.go:50: 为会话设置发送回调函数 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:14 ordered_sender.go:82: 有序消息发送成功 - 序列号: 5, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:14 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 5, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 1
2025/08/08 20:34:14 handlers.go:328: 同步处理连接建立请求成功 - OpenID: 42300, 客户端: 42300, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 状态: 1
2025/08/08 20:34:14 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 1, 成功: true, 处理时延: 0.54ms
2025/08/08 20:34:14 server_connection.go:299: 开始事件驱动消息处理 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:14 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:14.4920579 +0800 CST m=+76.120012501, 处理开始时间: 2025-08-08 20:34:14.4915405 +0800 CST m=+76.119495101
2025/08/08 20:34:14 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 5
2025/08/08 20:34:14 handlers.go:257: 收到ACK确认 - 序列号: 5, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:14 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.06ms
2025/08/08 20:34:18 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:18.5844862 +0800 CST m=+80.212210401, 处理开始时间: 2025-08-08 20:34:14.4920579 +0800 CST m=+76.120012501
2025/08/08 20:34:18 handlers.go:51: 处理业务请求 - 动作: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:18 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:34:18 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:34:18 ordered_sender.go:82: 有序消息发送成功 - 序列号: 6, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:18 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 6, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4
2025/08/08 20:34:18 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4, 成功: false, 处理时延: 0.51ms
2025/08/08 20:34:18 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:18.5855215 +0800 CST m=+80.213245601, 处理开始时间: 2025-08-08 20:34:18.5844862 +0800 CST m=+80.212210401
2025/08/08 20:34:18 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 6
2025/08/08 20:34:18 handlers.go:257: 收到ACK确认 - 序列号: 6, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:18 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:19 unicast_service.go:141: 收到广播推送请求 - 消息类型: system, 标题: 系统广播
2025/08/08 20:34:19 ordered_sender.go:82: 有序消息发送成功 - 序列号: 7, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:19 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 7, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 3
2025/08/08 20:34:19 unicast_service.go:164: 广播推送完成 - 广播消息已发送到 1/1 个在线客户端
2025/08/08 20:34:19 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:19.5519891 +0800 CST m=+81.179658801, 处理开始时间: 2025-08-08 20:34:18.5855215 +0800 CST m=+80.213245601
2025/08/08 20:34:19 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 7
2025/08/08 20:34:19 handlers.go:257: 收到ACK确认 - 序列号: 7, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:19 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:41 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:41.4099127 +0800 CST m=+103.036351801, 处理开始时间: 2025-08-08 20:34:19.5519891 +0800 CST m=+81.179658801
2025/08/08 20:34:41 handlers.go:51: 处理业务请求 - 动作: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:41 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:34:41 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:34:41 ordered_sender.go:82: 有序消息发送成功 - 序列号: 8, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:41 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 8, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4
2025/08/08 20:34:41 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4, 成功: false, 处理时延: 0.00ms
2025/08/08 20:34:41 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:41.4104476 +0800 CST m=+103.036886701, 处理开始时间: 2025-08-08 20:34:41.4099127 +0800 CST m=+103.036351801
2025/08/08 20:34:41 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 8
2025/08/08 20:34:41 handlers.go:257: 收到ACK确认 - 序列号: 8, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:41 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:44 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:44.0670773 +0800 CST m=+105.693366801, 处理开始时间: 2025-08-08 20:34:41.4104476 +0800 CST m=+103.036886701
2025/08/08 20:34:44 handlers.go:51: 处理业务请求 - 动作: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:44 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:34:44 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:34:44 ordered_sender.go:82: 有序消息发送成功 - 序列号: 9, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:44 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 9, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4
2025/08/08 20:34:44 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4, 成功: false, 处理时延: 0.00ms
2025/08/08 20:34:44 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:44.0676095 +0800 CST m=+105.693899001, 处理开始时间: 2025-08-08 20:34:44.0670773 +0800 CST m=+105.693366801
2025/08/08 20:34:44 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 9
2025/08/08 20:34:44 handlers.go:257: 收到ACK确认 - 序列号: 9, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:44 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:44 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:44.4931945 +0800 CST m=+106.119460001, 处理开始时间: 2025-08-08 20:34:44.0676095 +0800 CST m=+105.693899001
2025/08/08 20:34:44 ordered_sender.go:82: 有序消息发送成功 - 序列号: 10, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:44 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 10, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 2
2025/08/08 20:34:44 handlers.go:44: 处理心跳请求 - 客户端: 42300, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:44 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 3, 成功: true, 处理时延: 0.59ms
2025/08/08 20:34:44 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:44.4948786 +0800 CST m=+106.121144001, 处理开始时间: 2025-08-08 20:34:44.4931945 +0800 CST m=+106.119460001
2025/08/08 20:34:44 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 10
2025/08/08 20:34:44 handlers.go:257: 收到ACK确认 - 序列号: 10, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:44 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:45 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:45.9618897 +0800 CST m=+107.588072501, 处理开始时间: 2025-08-08 20:34:44.4948786 +0800 CST m=+106.121144001
2025/08/08 20:34:45 handlers.go:51: 处理业务请求 - 动作: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:45 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:34:45 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:34:45 ordered_sender.go:82: 有序消息发送成功 - 序列号: 11, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:45 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 11, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4
2025/08/08 20:34:45 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4, 成功: false, 处理时延: 0.00ms
2025/08/08 20:34:45 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:45.9624343 +0800 CST m=+107.588617101, 处理开始时间: 2025-08-08 20:34:45.9618897 +0800 CST m=+107.588072501
2025/08/08 20:34:45 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 11
2025/08/08 20:34:45 handlers.go:257: 收到ACK确认 - 序列号: 11, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:45 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:47 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:47.0485133 +0800 CST m=+108.674635001, 处理开始时间: 2025-08-08 20:34:45.9624343 +0800 CST m=+107.588617101
2025/08/08 20:34:47 handlers.go:51: 处理业务请求 - 动作: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:47 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:34:47 handlers.go:145: 调用上游服务失败 - 服务: zone(localhost:8083), 错误: rpc error: code = Unavailable desc = connection error: desc = "transport: Error while dialing: dial tcp [::1]:8083: connectex: No connection could be made because the target machine actively refused it."
2025/08/08 20:34:47 ordered_sender.go:82: 有序消息发送成功 - 序列号: 12, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:47 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 12, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4
2025/08/08 20:34:47 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 4, 成功: false, 处理时延: 0.51ms
2025/08/08 20:34:47 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:47.0490187 +0800 CST m=+108.675140301, 处理开始时间: 2025-08-08 20:34:47.0485133 +0800 CST m=+108.674635001
2025/08/08 20:34:47 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 12
2025/08/08 20:34:47 handlers.go:257: 收到ACK确认 - 序列号: 12, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:47 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:34:49 unicast_service.go:141: 收到广播推送请求 - 消息类型: system, 标题: 系统广播
2025/08/08 20:34:49 ordered_sender.go:82: 有序消息发送成功 - 序列号: 13, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6
2025/08/08 20:34:49 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 13, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 3
2025/08/08 20:34:49 unicast_service.go:164: 广播推送完成 - 广播消息已发送到 1/1 个在线客户端
2025/08/08 20:34:49 server_connection.go:121: 处理消息 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 读取时间: 2025-08-08 20:34:49.5536044 +0800 CST m=+111.179585001, 处理开始时间: 2025-08-08 20:34:47.0490187 +0800 CST m=+108.675140301
2025/08/08 20:34:49 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 客户端ACK: 13
2025/08/08 20:34:49 handlers.go:257: 收到ACK确认 - 序列号: 13, 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 清除消息数: 1
2025/08/08 20:34:49 server_connection.go:190: 消息处理完成 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:35:00 server_connection.go:291: 读取消息出错，退出读取协程 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:35:00 server_connection.go:328: 读取消息失败 - 会话: 4c009d21-86b0-458a-9be7-783c2b564fc6, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:35:02 main.go:294: 收到停止信号，正在关闭服务器...
2025/08/08 20:35:02 server.go:184: 正在停止网关服务器...
2025/08/08 20:35:02 manager.go:153: 上游服务管理器已关闭
2025/08/08 20:35:02 server.go:237: 网关服务器已停止
2025/08/08 20:35:02 main.go:300: 服务器已停止
2025/08/08 20:35:48 server.go:110: 添加上游服务 - 类型: hello, 地址: [localhost:8081]
2025/08/08 20:35:48 server.go:110: 添加上游服务 - 类型: business, 地址: [localhost:8082]
2025/08/08 20:35:48 server.go:110: 添加上游服务 - 类型: zone, 地址: [localhost:8083]
2025/08/08 20:35:48 server.go:122: 上游服务初始化完成 - 总服务数: 3, 已启用: 3
2025/08/08 20:35:48 overload_protector.go:155: 过载保护器已启用 - 最大连接: 1000, 最大QPS: 2000, 最大上游并发: 100
2025/08/08 20:35:48 server.go:128: 启动网关服务器...
2025/08/08 20:35:48 server_start.go:166: 已初始化上游服务连接管理器 - 配置服务数: 3
2025/08/08 20:35:48 manager.go:87: 已连接到上游服务: localhost:8082
2025/08/08 20:35:48 server_start.go:155: 预连接上游服务成功 - business
2025/08/08 20:35:48 manager.go:87: 已连接到上游服务: localhost:8081
2025/08/08 20:35:48 server_start.go:155: 预连接上游服务成功 - hello
2025/08/08 20:35:48 manager.go:87: 已连接到上游服务: localhost:8083
2025/08/08 20:35:48 server_start.go:155: 预连接上游服务成功 - zone
2025/08/08 20:35:48 server_start.go:38: QUIC监听器已启动: :8453
2025/08/08 20:35:48 server_start.go:81: HTTP服务器已启动: :8080
2025/08/08 20:35:48 server_start.go:95: 监控服务器已启动: :9090
2025/08/08 20:35:48 server.go:172: 网关服务器启动完成
2025/08/08 20:35:48 server_start.go:113: gRPC服务器已启动: :8092
2025/08/08 20:35:48 server.go:173: QUIC监听地址: :8453
2025/08/08 20:35:48 server.go:174: HTTP监听地址: :8080
2025/08/08 20:35:48 server.go:175: gRPC监听地址: :8092
2025/08/08 20:35:48 server.go:176: 监控地址: :9090
2025/08/08 20:35:48 server.go:177: 上游服务地址: 
2025/08/08 20:35:48 main.go:291: 网关服务器正在运行... (按Ctrl+C停止)
2025/08/08 20:35:55 server_connection.go:75: 新的QUIC连接: 127.0.0.1:62917
2025/08/08 20:35:55 server_connection.go:197: 等待第一个消息以获取身份标识 - 连接: 127.0.0.1:62917
2025/08/08 20:35:55 server_connection.go:241: 从第一个消息中提取身份信息 - OpenID: 22200, ClientID: 
2025/08/08 20:35:55 server_connection.go:245: 根据第一个消息提取出session - sessionid: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:55 server_connection.go:101: 创建会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:55 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:35:55.7369853 +0800 CST m=+7.011806001, 处理开始时间: 2025-08-08 20:35:55.7369853 +0800 CST m=+7.011806001
2025/08/08 20:35:55 handlers.go:274: 同步处理start请求 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 消息ID: 1
2025/08/08 20:35:55 ordered_sender.go:50: 为会话设置发送回调函数 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:55 ordered_sender.go:82: 有序消息发送成功 - 序列号: 1, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:55 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 1, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 1
2025/08/08 20:35:55 handlers.go:328: 同步处理连接建立请求成功 - OpenID: 22200, 客户端: 22200, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 状态: 0
2025/08/08 20:35:55 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 1, 成功: true, 处理时延: 0.53ms
2025/08/08 20:35:55 server_connection.go:299: 开始事件驱动消息处理 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:55 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:35:55.7375107 +0800 CST m=+7.012331401, 处理开始时间: 2025-08-08 20:35:55.7375107 +0800 CST m=+7.012331401
2025/08/08 20:35:55 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 客户端ACK: 1
2025/08/08 20:35:55 handlers.go:257: 收到ACK确认 - 序列号: 1, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 清除消息数: 1
2025/08/08 20:35:55 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 5, 成功: true, 处理时延: 0.10ms
2025/08/08 20:35:57 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:35:57.3734655 +0800 CST m=+8.648194101, 处理开始时间: 2025-08-08 20:35:55.7375107 +0800 CST m=+7.012331401
2025/08/08 20:35:57 handlers.go:51: 处理业务请求 - 动作: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:57 handlers.go:136: 路由业务请求 - 动作: hello, 目标服务: hello(localhost:8081)
2025/08/08 20:35:57 handlers.go:212: 登录成功，会话已激活 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, Zone: 1
2025/08/08 20:35:57 ordered_sender.go:82: 有序消息发送成功 - 序列号: 2, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:57 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 2, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 3
2025/08/08 20:35:57 handlers.go:181: 处理业务请求 - 动作: hello, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 响应码: 200, 时延: 解析=0.00ms, 上游=1.06ms
2025/08/08 20:35:57 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 4, 成功: true, 处理时延: 1.60ms
2025/08/08 20:35:57 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:35:57.3750611 +0800 CST m=+8.649789601, 处理开始时间: 2025-08-08 20:35:57.3734655 +0800 CST m=+8.648194101
2025/08/08 20:35:57 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 客户端ACK: 2
2025/08/08 20:35:57 handlers.go:257: 收到ACK确认 - 序列号: 2, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 清除消息数: 1
2025/08/08 20:35:57 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:35:58 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:35:58.6226462 +0800 CST m=+9.897304401, 处理开始时间: 2025-08-08 20:35:57.3750611 +0800 CST m=+8.649789601
2025/08/08 20:35:58 handlers.go:51: 处理业务请求 - 动作: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:58 handlers.go:136: 路由业务请求 - 动作: time, 目标服务: zone(localhost:8083)
2025/08/08 20:35:58 ordered_sender.go:82: 有序消息发送成功 - 序列号: 3, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:35:58 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 3, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 3
2025/08/08 20:35:58 handlers.go:181: 处理业务请求 - 动作: time, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 响应码: 200, 时延: 解析=0.00ms, 上游=1.76ms
2025/08/08 20:35:58 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 4, 成功: true, 处理时延: 1.76ms
2025/08/08 20:35:58 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:35:58.6249371 +0800 CST m=+9.899595201, 处理开始时间: 2025-08-08 20:35:58.6226462 +0800 CST m=+9.897304401
2025/08/08 20:35:58 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 客户端ACK: 3
2025/08/08 20:35:58 handlers.go:257: 收到ACK确认 - 序列号: 3, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 清除消息数: 1
2025/08/08 20:35:58 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:36:07 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:36:07.7843234 +0800 CST m=+19.058465801, 处理开始时间: 2025-08-08 20:35:58.6249371 +0800 CST m=+9.899595201
2025/08/08 20:36:07 handlers.go:51: 处理业务请求 - 动作: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:36:07 handlers.go:136: 路由业务请求 - 动作: echo, 目标服务: zone(localhost:8083)
2025/08/08 20:36:07 ordered_sender.go:82: 有序消息发送成功 - 序列号: 4, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b
2025/08/08 20:36:07 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 4, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 3
2025/08/08 20:36:07 handlers.go:181: 处理业务请求 - 动作: echo, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 响应码: 200, 时延: 解析=0.00ms, 上游=0.53ms
2025/08/08 20:36:07 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 4, 成功: true, 处理时延: 0.53ms
2025/08/08 20:36:07 server_connection.go:121: 处理消息 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 读取时间: 2025-08-08 20:36:07.7858979 +0800 CST m=+19.060040201, 处理开始时间: 2025-08-08 20:36:07.7843234 +0800 CST m=+19.058465801
2025/08/08 20:36:07 ordered_sender.go:172: 会话序列号重同步完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 客户端ACK: 4
2025/08/08 20:36:07 handlers.go:257: 收到ACK确认 - 序列号: 4, 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 清除消息数: 1
2025/08/08 20:36:07 server_connection.go:190: 消息处理完成 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:36:13 server_connection.go:291: 读取消息出错，退出读取协程 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:36:13 server_connection.go:328: 读取消息失败 - 会话: 6cc7b7b6-b0c1-44d2-a84e-6242187d8b9b, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:36:17 server_connection.go:75: 新的QUIC连接: 127.0.0.1:55196
2025/08/08 20:36:17 server_connection.go:197: 等待第一个消息以获取身份标识 - 连接: 127.0.0.1:55196
2025/08/08 20:36:17 server_connection.go:241: 从第一个消息中提取身份信息 - OpenID: 22200, ClientID: 
2025/08/08 20:36:17 server_connection.go:245: 根据第一个消息提取出session - sessionid: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:17 server_connection.go:247: 检测到重连 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 客户端: , 用户: 22200
2025/08/08 20:36:17 server_connection.go:101: 创建会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:17 server_connection.go:121: 处理消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 读取时间: 2025-08-08 20:36:17.2308226 +0800 CST m=+28.504433201, 处理开始时间: 2025-08-08 20:36:17.2308226 +0800 CST m=+28.504433201
2025/08/08 20:36:17 handlers.go:274: 同步处理start请求 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 消息ID: 5
2025/08/08 20:36:17 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 客户端ACK: 4
2025/08/08 20:36:17 handlers.go:317: 重连时清除已确认消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 最后确认序列号: 4, 清除数量: 0
2025/08/08 20:36:17 ordered_sender.go:50: 为会话设置发送回调函数 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:17 ordered_sender.go:82: 有序消息发送成功 - 序列号: 5, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:17 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 5, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 1
2025/08/08 20:36:17 handlers.go:328: 同步处理连接建立请求成功 - OpenID: 22200, 客户端: 22200, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 状态: 1
2025/08/08 20:36:17 server_connection.go:190: 消息处理完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 1, 成功: true, 处理时延: 0.54ms
2025/08/08 20:36:17 server_connection.go:299: 开始事件驱动消息处理 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:17 server_connection.go:121: 处理消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 读取时间: 2025-08-08 20:36:17.2313577 +0800 CST m=+28.504968301, 处理开始时间: 2025-08-08 20:36:17.2313577 +0800 CST m=+28.504968301
2025/08/08 20:36:17 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 客户端ACK: 5
2025/08/08 20:36:17 handlers.go:257: 收到ACK确认 - 序列号: 5, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 清除消息数: 1
2025/08/08 20:36:17 server_connection.go:190: 消息处理完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 5, 成功: true, 处理时延: 0.52ms
2025/08/08 20:36:19 unicast_service.go:141: 收到广播推送请求 - 消息类型: system, 标题: 系统广播
2025/08/08 20:36:19 ordered_sender.go:82: 有序消息发送成功 - 序列号: 6, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:19 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 6, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 3
2025/08/08 20:36:19 unicast_service.go:164: 广播推送完成 - 广播消息已发送到 1/1 个在线客户端
2025/08/08 20:36:19 server_connection.go:121: 处理消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 读取时间: 2025-08-08 20:36:19.55831 +0800 CST m=+30.831789601, 处理开始时间: 2025-08-08 20:36:17.2313577 +0800 CST m=+28.504968301
2025/08/08 20:36:19 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 客户端ACK: 6
2025/08/08 20:36:19 handlers.go:257: 收到ACK确认 - 序列号: 6, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 清除消息数: 1
2025/08/08 20:36:19 server_connection.go:190: 消息处理完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:36:47 server_connection.go:121: 处理消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 读取时间: 2025-08-08 20:36:47.2331275 +0800 CST m=+58.505049001, 处理开始时间: 2025-08-08 20:36:19.55831 +0800 CST m=+30.831789601
2025/08/08 20:36:47 ordered_sender.go:82: 有序消息发送成功 - 序列号: 7, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:47 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 7, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 2
2025/08/08 20:36:47 handlers.go:44: 处理心跳请求 - 客户端: 22200, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:47 server_connection.go:190: 消息处理完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 3, 成功: true, 处理时延: 0.56ms
2025/08/08 20:36:47 server_connection.go:121: 处理消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 读取时间: 2025-08-08 20:36:47.2349258 +0800 CST m=+58.506847201, 处理开始时间: 2025-08-08 20:36:47.2331275 +0800 CST m=+58.505049001
2025/08/08 20:36:47 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 客户端ACK: 7
2025/08/08 20:36:47 handlers.go:257: 收到ACK确认 - 序列号: 7, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 清除消息数: 1
2025/08/08 20:36:47 server_connection.go:190: 消息处理完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:36:49 unicast_service.go:141: 收到广播推送请求 - 消息类型: system, 标题: 系统广播
2025/08/08 20:36:49 ordered_sender.go:82: 有序消息发送成功 - 序列号: 8, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220
2025/08/08 20:36:49 ordered_sender.go:59: 消息已加入有序队列 - 序列号: 8, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 3
2025/08/08 20:36:49 unicast_service.go:164: 广播推送完成 - 广播消息已发送到 1/1 个在线客户端
2025/08/08 20:36:49 server_connection.go:121: 处理消息 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 读取时间: 2025-08-08 20:36:49.5607 +0800 CST m=+60.832490401, 处理开始时间: 2025-08-08 20:36:47.2349258 +0800 CST m=+58.506847201
2025/08/08 20:36:49 ordered_sender.go:172: 会话序列号重同步完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 客户端ACK: 8
2025/08/08 20:36:49 handlers.go:257: 收到ACK确认 - 序列号: 8, 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 清除消息数: 1
2025/08/08 20:36:49 server_connection.go:190: 消息处理完成 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 类型: 5, 成功: true, 处理时延: 0.00ms
2025/08/08 20:36:57 server_connection.go:291: 读取消息出错，退出读取协程 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:36:57 server_connection.go:328: 读取消息失败 - 会话: fb84f4d3-6867-4140-95e6-3576d27aa220, 错误: 读取消息头失败: Application error 0x0 (remote): client disconnect
2025/08/08 20:36:59 main.go:294: 收到停止信号，正在关闭服务器...
2025/08/08 20:36:59 server.go:184: 正在停止网关服务器...
2025/08/08 20:36:59 manager.go:153: 上游服务管理器已关闭
2025/08/08 20:36:59 server.go:237: 网关服务器已停止
2025/08/08 20:36:59 main.go:300: 服务器已停止
2025/08/09 19:18:58 server.go:110: 添加上游服务 - 类型: hello, 地址: [localhost:8081]
2025/08/09 19:18:58 server.go:110: 添加上游服务 - 类型: business, 地址: [localhost:8082]
2025/08/09 19:18:58 server.go:110: 添加上游服务 - 类型: zone, 地址: [localhost:8083]
2025/08/09 19:18:58 server.go:122: 上游服务初始化完成 - 总服务数: 3, 已启用: 3
2025/08/09 19:18:58 overload_protector.go:155: 过载保护器已启用 - 最大连接: 1000, 最大QPS: 2000, 最大上游并发: 100
2025/08/09 19:18:58 server.go:128: 启动网关服务器...
2025/08/09 19:18:58 server_start.go:166: 已初始化上游服务连接管理器 - 配置服务数: 3
2025/08/09 19:18:58 manager.go:87: 已连接到上游服务: localhost:8081
2025/08/09 19:18:58 server_start.go:155: 预连接上游服务成功 - hello
2025/08/09 19:18:58 manager.go:87: 已连接到上游服务: localhost:8082
2025/08/09 19:18:58 server_start.go:155: 预连接上游服务成功 - business
2025/08/09 19:18:58 manager.go:87: 已连接到上游服务: localhost:8083
2025/08/09 19:18:58 server_start.go:155: 预连接上游服务成功 - zone
2025/08/09 19:18:58 server_start.go:38: QUIC监听器已启动: :8453
2025/08/09 19:18:58 server_start.go:81: HTTP服务器已启动: :8080
2025/08/09 19:18:58 server_start.go:95: 监控服务器已启动: :9090
2025/08/09 19:18:58 server_start.go:113: gRPC服务器已启动: :8092
2025/08/09 19:18:58 server.go:172: 网关服务器启动完成
2025/08/09 19:18:58 server.go:173: QUIC监听地址: :8453
2025/08/09 19:18:58 server.go:174: HTTP监听地址: :8080
2025/08/09 19:18:58 server.go:175: gRPC监听地址: :8092
2025/08/09 19:18:58 server.go:176: 监控地址: :9090
2025/08/09 19:18:58 server.go:177: 上游服务地址: 
2025/08/09 19:18:58 main.go:291: 网关服务器正在运行... (按Ctrl+C停止)
2025/08/09 19:48:44 main.go:294: 收到停止信号，正在关闭服务器...
2025/08/09 19:48:44 server.go:184: 正在停止网关服务器...
2025/08/09 19:48:44 manager.go:153: 上游服务管理器已关闭
2025/08/09 19:48:44 server.go:237: 网关服务器已停止
2025/08/09 19:48:44 main.go:300: 服务器已停止
